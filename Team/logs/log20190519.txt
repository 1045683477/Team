2019-05-19 15:31:28.935 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 15:31:30.372 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 15:31:30.632 +08:00 [INF] Request finished in 263.0059ms 200 text/html
2019-05-19 15:31:31.252 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 15:31:31.430 +08:00 [INF] Request finished in 177.8486ms 200 application/json;charset=utf-8
2019-05-19 15:38:50.421 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 15:38:51.780 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 15:38:51.944 +08:00 [INF] Request finished in 168.4885ms 200 text/html
2019-05-19 15:38:52.516 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 15:38:52.703 +08:00 [INF] Request finished in 187.8338ms 200 application/json;charset=utf-8
2019-05-19 15:39:28.712 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 15:39:28.837 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 15:39:28.863 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 15:39:29.310 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:39:29.785 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 15:39:29.790 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 15:39:29.793 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 15:39:29.796 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:39:30.238 +08:00 [INF] Executed DbCommand (708ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:39:30.238 +08:00 [INF] Executed DbCommand (428ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:39:30.658 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 15:39:30.658 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 15:39:31.044 +08:00 [INF] Executed DbCommand (260ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 15:39:31.044 +08:00 [INF] Executed DbCommand (260ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 15:39:31.127 +08:00 [INF] 用户 1登陆成功
2019-05-19 15:39:31.127 +08:00 [INF] 用户 1登陆成功
2019-05-19 15:39:31.133 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 470.20430000000005ms.
2019-05-19 15:39:31.133 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 468.2387ms.
2019-05-19 15:39:31.146 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:39:31.146 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:39:31.158 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 2289.2653ms
2019-05-19 15:39:31.158 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1361.1451ms
2019-05-19 15:39:31.161 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 15:39:31.162 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 15:39:31.170 +08:00 [INF] Request finished in 2457.3306ms 200 application/json; charset=utf-8
2019-05-19 15:39:31.170 +08:00 [INF] Request finished in 1384.9054ms 200 application/json; charset=utf-8
2019-05-19 15:39:47.074 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 15:39:47.093 +08:00 [INF] Successfully validated the token.
2019-05-19 15:39:47.096 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 15:39:47.105 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 15:39:47.117 +08:00 [INF] Authorization was successful.
2019-05-19 15:39:47.120 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:39:47.146 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:39:47.173 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 15:39:47.240 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:39:47.285 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:39:47.290 +08:00 [INF] 用户 1 创建跑步队伍失败
2019-05-19 15:39:47.291 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 115.44170000000001ms.
2019-05-19 15:39:47.293 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:39:47.295 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 185.836ms
2019-05-19 15:39:47.297 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 15:39:47.299 +08:00 [INF] Request finished in 224.9481ms 500 application/json; charset=utf-8
2019-05-19 15:39:59.809 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 15:39:59.811 +08:00 [INF] Successfully validated the token.
2019-05-19 15:39:59.816 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 15:39:59.823 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 15:39:59.825 +08:00 [INF] Authorization was successful.
2019-05-19 15:39:59.826 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:39:59.936 +08:00 [INF] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:39:59.959 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 15:40:00.118 +08:00 [INF] Executed DbCommand (148ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 15:40:00.167 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:40:00.304 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 15:40:00.306 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 343.3405ms.
2019-05-19 15:40:00.309 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:40:00.311 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 485.8109ms
2019-05-19 15:40:00.313 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 15:40:00.318 +08:00 [ERR] Connection id "0HLMS5K4MEUIK", Request id "0HLMS5K4MEUIK:00000005": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 15:40:00.434 +08:00 [INF] Request finished in 625.4612ms 200 application/json; charset=utf-8
2019-05-19 15:40:00.765 +08:00 [INF] Executed DbCommand (507ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 15:40:00.862 +08:00 [INF] Executed DbCommand (56ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 15:40:15.107 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 53
2019-05-19 15:40:15.111 +08:00 [INF] Successfully validated the token.
2019-05-19 15:40:15.114 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 15:40:15.118 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 15:40:15.125 +08:00 [INF] Authorization was successful.
2019-05-19 15:40:15.129 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:40:15.161 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:40:15.185 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 15:40:15.316 +08:00 [INF] Executed DbCommand (127ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:40:15.351 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:40:15.401 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:40:15.451 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 15:40:15.454 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 265.3635ms.
2019-05-19 15:40:15.460 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:40:15.482 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 356.78810000000004ms
2019-05-19 15:40:15.484 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 15:40:15.487 +08:00 [ERR] Connection id "0HLMS5K4MEUIK", Request id "0HLMS5K4MEUIK:00000006": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 15:40:15.504 +08:00 [INF] Request finished in 396.0896ms 201 application/json; charset=utf-8
2019-05-19 15:40:15.508 +08:00 [INF] Executed DbCommand (90ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 15:40:15.565 +08:00 [INF] Executed DbCommand (29ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 15:40:15.603 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[@p10='?' (DbType = DateTime2), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 15:41:40.395 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 15:41:41.894 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 15:41:42.046 +08:00 [INF] Request finished in 154.2019ms 200 text/html
2019-05-19 15:41:42.610 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 15:41:42.804 +08:00 [INF] Request finished in 193.7672ms 200 application/json;charset=utf-8
2019-05-19 15:41:54.989 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 15:41:55.058 +08:00 [INF] Successfully validated the token.
2019-05-19 15:41:55.089 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 15:41:55.103 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 15:41:55.114 +08:00 [INF] Authorization was successful.
2019-05-19 15:41:55.608 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:41:55.902 +08:00 [INF] Executed DbCommand (139ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:41:56.229 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 15:41:56.358 +08:00 [INF] Executed DbCommand (37ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 15:41:56.438 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:41:56.578 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 15:41:56.583 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 346.8893ms.
2019-05-19 15:41:56.593 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:41:56.603 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 1494.6144000000002ms
2019-05-19 15:41:56.606 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 15:41:56.609 +08:00 [ERR] Connection id "0HLMS5LNEUUQD", Request id "0HLMS5LNEUUQD:00000003": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 15:41:56.650 +08:00 [INF] Executed DbCommand (128ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 15:41:56.677 +08:00 [INF] Request finished in 1688.5577ms 200 application/json; charset=utf-8
2019-05-19 15:41:56.742 +08:00 [INF] Executed DbCommand (42ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 15:43:25.747 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 56
2019-05-19 15:43:25.776 +08:00 [INF] Successfully validated the token.
2019-05-19 15:43:25.782 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 15:43:25.820 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 15:43:25.825 +08:00 [INF] Authorization was successful.
2019-05-19 15:43:25.833 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:43:25.941 +08:00 [INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:43:26.009 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 15:43:26.096 +08:00 [INF] Executed DbCommand (79ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:43:26.150 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:43:26.211 +08:00 [INF] Executed DbCommand (29ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:43:26.257 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 15:43:26.259 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 15:43:26.259 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 247.0002ms.
2019-05-19 15:43:26.268 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:43:26.295 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 15:43:26.329 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@p10='?' (DbType = DateTime2), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 15:43:26.331 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 507.02930000000003ms
2019-05-19 15:43:26.337 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 15:43:26.342 +08:00 [INF] Request finished in 597.5015ms 201 application/json; charset=utf-8
2019-05-19 15:55:58.166 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 15:55:59.669 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 15:55:59.845 +08:00 [INF] Request finished in 179.8192ms 200 text/html
2019-05-19 15:56:00.459 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 15:56:00.663 +08:00 [INF] Request finished in 204.417ms 200 application/json;charset=utf-8
2019-05-19 15:56:17.527 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 15:56:17.591 +08:00 [INF] Successfully validated the token.
2019-05-19 15:56:17.624 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 15:56:17.638 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 15:56:17.653 +08:00 [INF] Authorization was successful.
2019-05-19 15:56:17.992 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:56:18.345 +08:00 [INF] Executed DbCommand (234ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:56:18.632 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 15:56:18.783 +08:00 [INF] Executed DbCommand (64ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 15:56:18.880 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:56:19.032 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 15:56:19.037 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 399.7364ms.
2019-05-19 15:56:19.047 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:56:19.059 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 1414.0458ms
2019-05-19 15:56:19.061 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 15:56:19.065 +08:00 [ERR] Connection id "0HLMS5TN2TF9H", Request id "0HLMS5TN2TF9H:00000003": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 15:56:19.125 +08:00 [INF] Request finished in 1597.9234ms 200 application/json; charset=utf-8
2019-05-19 15:56:19.231 +08:00 [INF] Executed DbCommand (257ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 15:56:19.309 +08:00 [INF] Executed DbCommand (50ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 15:56:45.734 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 15:56:45.740 +08:00 [INF] Successfully validated the token.
2019-05-19 15:56:45.746 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 15:56:45.762 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 15:56:45.766 +08:00 [INF] Authorization was successful.
2019-05-19 15:56:45.786 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 15:56:45.827 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 15:56:45.896 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 15:56:45.956 +08:00 [INF] Executed DbCommand (52ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:56:46.007 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:56:46.054 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 15:56:46.096 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 15:56:46.097 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 197.2671ms.
2019-05-19 15:56:46.100 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 15:56:46.113 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 347.0086ms
2019-05-19 15:56:46.116 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 15:56:46.120 +08:00 [ERR] Connection id "0HLMS5TN2TF9H", Request id "0HLMS5TN2TF9H:00000004": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 15:56:46.129 +08:00 [INF] Request finished in 395.1359ms 201 application/json; charset=utf-8
2019-05-19 15:56:46.171 +08:00 [INF] Executed DbCommand (105ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 15:56:46.211 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 15:56:46.241 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@p10='?' (DbType = DateTime2), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:15:56.067 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:15:57.464 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:15:57.813 +08:00 [INF] Request finished in 353.1015ms 200 text/html
2019-05-19 16:15:58.359 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:15:58.549 +08:00 [INF] Request finished in 189.7197ms 200 application/json;charset=utf-8
2019-05-19 16:16:16.459 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:16:16.545 +08:00 [INF] Successfully validated the token.
2019-05-19 16:16:16.580 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:16:16.606 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:16:16.618 +08:00 [INF] Authorization was successful.
2019-05-19 16:16:17.096 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:16:17.307 +08:00 [INF] Executed DbCommand (95ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:16:17.657 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:16:17.788 +08:00 [INF] Executed DbCommand (41ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:16:17.893 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:16:17.898 +08:00 [INF] 用户 1 创建跑步队伍失败
2019-05-19 16:16:17.905 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 239.70420000000001ms.
2019-05-19 16:16:17.915 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 16:16:17.927 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 1315.2571ms
2019-05-19 16:16:17.930 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:16:17.932 +08:00 [INF] Request finished in 1472.9884ms 500 application/json; charset=utf-8
2019-05-19 16:16:25.136 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 16:16:25.139 +08:00 [INF] Successfully validated the token.
2019-05-19 16:16:25.144 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 16:16:25.150 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:16:25.155 +08:00 [INF] Authorization was successful.
2019-05-19 16:16:25.157 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:16:25.189 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:16:25.216 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:16:25.264 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 16:16:25.312 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:16:25.460 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 16:16:25.462 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 243.36ms.
2019-05-19 16:16:25.466 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 16:16:25.469 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 314.7928ms
2019-05-19 16:16:25.473 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 16:16:25.478 +08:00 [ERR] Connection id "0HLMS68S2GQ5Q", Request id "0HLMS68S2GQ5Q:00000004": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 16:16:25.557 +08:00 [INF] Executed DbCommand (163ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 16:16:25.567 +08:00 [INF] Request finished in 430.7125ms 200 application/json; charset=utf-8
2019-05-19 16:16:25.631 +08:00 [INF] Executed DbCommand (35ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 16:16:40.342 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:16:40.345 +08:00 [INF] Successfully validated the token.
2019-05-19 16:16:40.349 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:16:40.354 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:16:40.362 +08:00 [INF] Authorization was successful.
2019-05-19 16:16:40.363 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:16:40.395 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:16:40.422 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:16:40.451 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:16:40.484 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:16:40.607 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 16:16:40.672 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 310.8557ms
2019-05-19 16:16:40.676 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:16:40.678 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at Team.Infrastructure.Repositories.RunTeamResource.TeamSearchByIdTeaming(Int32 teamId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 129
   at Team.Infrastructure.Repositories.RunTeamResource.TeamCreate(RunParticipants participants, RunTeam runTeam, Int32 userId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 62
   at Team.Controllers.RunTeamController.RunTeamApi(RunTeamCreateMap runTeam) in D:\Microsoft VS2017\Word\.net core API\Team\Team\Controllers\RunTeamController.cs:line 64
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-19 16:16:40.697 +08:00 [INF] Executed DbCommand (175ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:16:40.776 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:16:40.802 +08:00 [INF] Request finished in 460.3859ms 500 text/html; charset=utf-8
2019-05-19 16:20:04.095 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:20:05.640 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:20:05.803 +08:00 [INF] Request finished in 165.5293ms 200 text/html
2019-05-19 16:20:06.413 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:20:06.600 +08:00 [INF] Request finished in 187.6294ms 200 application/json;charset=utf-8
2019-05-19 16:20:22.588 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 16:20:22.664 +08:00 [INF] Successfully validated the token.
2019-05-19 16:20:22.696 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 16:20:22.711 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:20:22.723 +08:00 [INF] Authorization was successful.
2019-05-19 16:20:23.174 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:20:23.396 +08:00 [INF] Executed DbCommand (109ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:20:23.733 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:20:23.859 +08:00 [INF] Executed DbCommand (39ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 16:20:23.911 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:20:23.969 +08:00 [INF] 用户 1 自身并没有创建队伍，删除失败！
2019-05-19 16:20:23.974 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 234.25840000000002ms.
2019-05-19 16:20:23.987 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 16:20:24.000 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 1282.5326ms
2019-05-19 16:20:24.002 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 16:20:24.006 +08:00 [INF] Request finished in 1418.5382ms 404 application/json; charset=utf-8
2019-05-19 16:20:46.503 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:20:46.509 +08:00 [INF] Successfully validated the token.
2019-05-19 16:20:46.514 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:20:46.530 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:20:46.539 +08:00 [INF] Authorization was successful.
2019-05-19 16:20:46.543 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:20:46.607 +08:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:20:46.687 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:20:46.732 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:20:46.786 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:20:46.938 +08:00 [INF] Executed DbCommand (56ms) [Parameters=[@__teamId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[Id] = @__teamId_0
ORDER BY [x].[Id]
2019-05-19 16:20:47.007 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 469.02660000000003ms
2019-05-19 16:20:47.010 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:20:47.012 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Team.Infrastructure.Repositories.RunTeamResource.TeamCreate(RunParticipants participants, RunTeam runTeam, Int32 userId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 64
   at Team.Controllers.RunTeamController.RunTeamApi(RunTeamCreateMap runTeam) in D:\Microsoft VS2017\Word\.net core API\Team\Team\Controllers\RunTeamController.cs:line 64
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-19 16:20:47.143 +08:00 [INF] Request finished in 640.1756ms 500 text/html; charset=utf-8
2019-05-19 16:21:08.909 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:21:08.917 +08:00 [INF] Successfully validated the token.
2019-05-19 16:21:08.923 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:21:08.926 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:21:08.930 +08:00 [INF] Authorization was successful.
2019-05-19 16:21:08.936 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:21:08.962 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:21:08.991 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:21:09.025 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:21:09.057 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:21:09.089 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__teamId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[Id] = @__teamId_0
ORDER BY [x].[Id]
2019-05-19 16:22:12.345 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:22:13.945 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:22:14.126 +08:00 [INF] Request finished in 185.1774ms 200 text/html
2019-05-19 16:22:14.880 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:22:15.089 +08:00 [INF] Request finished in 209.2382ms 200 application/json;charset=utf-8
2019-05-19 16:22:23.817 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:22:23.894 +08:00 [INF] Successfully validated the token.
2019-05-19 16:22:23.927 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:22:23.952 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:22:23.965 +08:00 [INF] Authorization was successful.
2019-05-19 16:22:24.303 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:22:24.539 +08:00 [INF] Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:22:24.813 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:22:24.846 +08:00 [INF] Successfully validated the token.
2019-05-19 16:22:24.851 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:22:24.853 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:22:24.858 +08:00 [INF] Authorization was successful.
2019-05-19 16:22:24.862 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:22:24.922 +08:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:22:25.004 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:22:25.004 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:22:25.164 +08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:22:25.164 +08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:22:25.296 +08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:22:25.329 +08:00 [INF] Executed DbCommand (35ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:22:25.648 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 16:22:25.648 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 16:22:25.730 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 1771.8272000000002ms
2019-05-19 16:22:25.800 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 942.6588ms
2019-05-19 16:22:25.802 +08:00 [INF] Executed DbCommand (306ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:22:25.803 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:22:25.805 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:22:25.814 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at Team.Infrastructure.Repositories.RunTeamResource.TeamSearchByIdTeaming(Int32 teamId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 129
   at Team.Infrastructure.Repositories.RunTeamResource.TeamCreate(RunParticipants participants, RunTeam runTeam, Int32 userId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 62
   at Team.Controllers.RunTeamController.RunTeamApi(RunTeamCreateMap runTeam) in D:\Microsoft VS2017\Word\.net core API\Team\Team\Controllers\RunTeamController.cs:line 64
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-19 16:22:25.816 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at Team.Infrastructure.Repositories.RunTeamResource.TeamSearchByIdTeaming(Int32 teamId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 129
   at Team.Infrastructure.Repositories.RunTeamResource.TeamCreate(RunParticipants participants, RunTeam runTeam, Int32 userId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 62
   at Team.Controllers.RunTeamController.RunTeamApi(RunTeamCreateMap runTeam) in D:\Microsoft VS2017\Word\.net core API\Team\Team\Controllers\RunTeamController.cs:line 64
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-19 16:22:25.874 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:22:25.950 +08:00 [ERR] Connection id "0HLMS6CC86Q7O", Request id "0HLMS6CC86Q7O:00000003": An unhandled exception was thrown by the application.
System.InvalidOperationException: There is already an open DataReader associated with this Command which must be closed first.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 16:22:25.965 +08:00 [ERR] Connection id "0HLMS6CC86Q7Q", Request id "0HLMS6CC86Q7Q:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 16:22:26.052 +08:00 [INF] Request finished in 2235.0934ms 500 text/html; charset=utf-8
2019-05-19 16:22:26.066 +08:00 [INF] Request finished in 1253.6885ms 500 text/html; charset=utf-8
2019-05-19 16:22:26.314 +08:00 [ERR] Failed executing DbCommand (817ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:bd1c2098-e6ba-4cc2-a93a-e001110f1521
Error Number:2601,State:1,Class:14
2019-05-19 16:29:41.877 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:29:43.296 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:29:43.496 +08:00 [INF] Request finished in 203.8619ms 200 text/html
2019-05-19 16:29:44.069 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:29:44.259 +08:00 [INF] Request finished in 189.6499ms 200 application/json;charset=utf-8
2019-05-19 16:29:54.579 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 16:29:54.660 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 16:29:54.687 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 16:29:55.188 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:29:55.519 +08:00 [INF] Executed DbCommand (226ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:29:55.910 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 16:29:56.107 +08:00 [INF] Executed DbCommand (62ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 16:29:56.194 +08:00 [INF] 用户 1登陆成功
2019-05-19 16:29:56.201 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 284.709ms.
2019-05-19 16:29:56.217 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 16:29:56.228 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1535.7458000000001ms
2019-05-19 16:29:56.234 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 16:29:56.241 +08:00 [INF] Request finished in 1662.069ms 200 application/json; charset=utf-8
2019-05-19 16:30:07.886 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:30:07.901 +08:00 [INF] Successfully validated the token.
2019-05-19 16:30:07.906 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:30:07.910 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:30:07.924 +08:00 [INF] Authorization was successful.
2019-05-19 16:30:07.927 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:30:07.956 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:30:07.989 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:30:08.156 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:30:08.201 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:30:08.370 +08:00 [ERR] Failed executing DbCommand (61ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:c973c633-6f26-4152-b962-63148073e6c9
Error Number:2601,State:1,Class:14
2019-05-19 16:30:08.438 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Team.Infrastructure.DbContext.MyContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-05-19 16:30:08.472 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@__teamId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[Id] = @__teamId_0
ORDER BY [x].[Id]
2019-05-19 16:30:08.637 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 720.7965ms
2019-05-19 16:30:08.640 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:30:08.643 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Team.Infrastructure.Repositories.RunTeamResource.TeamCreate(RunParticipants participants, RunTeam runTeam, Int32 userId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 64
   at Team.Controllers.RunTeamController.RunTeamApi(RunTeamCreateMap runTeam) in D:\Microsoft VS2017\Word\.net core API\Team\Team\Controllers\RunTeamController.cs:line 64
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-19 16:30:08.729 +08:00 [INF] Request finished in 842.5904ms 500 text/html; charset=utf-8
2019-05-19 16:32:56.249 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:32:57.737 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:32:57.891 +08:00 [INF] Request finished in 156.5732ms 200 text/html
2019-05-19 16:32:58.480 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:32:58.686 +08:00 [INF] Request finished in 205.774ms 200 application/json;charset=utf-8
2019-05-19 16:33:06.655 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 16:33:06.748 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 16:33:06.771 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 16:33:07.251 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:33:07.496 +08:00 [INF] Executed DbCommand (122ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:33:07.891 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 16:33:08.061 +08:00 [INF] Executed DbCommand (61ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 16:33:08.142 +08:00 [INF] 用户 1登陆成功
2019-05-19 16:33:08.149 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 252.37820000000002ms.
2019-05-19 16:33:08.165 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 16:33:08.182 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1404.4574ms
2019-05-19 16:33:08.186 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 16:33:08.198 +08:00 [INF] Request finished in 1543.0669ms 200 application/json; charset=utf-8
2019-05-19 16:33:22.149 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:33:22.160 +08:00 [INF] Successfully validated the token.
2019-05-19 16:33:22.166 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:33:22.171 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:33:22.203 +08:00 [INF] Authorization was successful.
2019-05-19 16:33:22.209 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:33:22.248 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:33:22.280 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:33:22.362 +08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:33:22.412 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:33:22.500 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:33:22.628 +08:00 [INF] Executed DbCommand (48ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:33:22.698 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 16:33:22.730 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[@p10='?' (DbType = DateTime2), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p10, @p11, @p12, @p13, @p14);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:33:22.780 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@__teamId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[Id] = @__teamId_0
ORDER BY [x].[Id]
2019-05-19 16:33:22.786 +08:00 [INF] 用户 1 创建跑步队伍失败
2019-05-19 16:33:22.787 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 504.46070000000003ms.
2019-05-19 16:33:22.796 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 16:33:22.797 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 603.01370000000009ms
2019-05-19 16:33:22.800 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:33:22.802 +08:00 [INF] Request finished in 653.6042ms 500 application/json; charset=utf-8
2019-05-19 16:39:10.779 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:39:12.261 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:39:12.440 +08:00 [INF] Request finished in 181.555ms 200 text/html
2019-05-19 16:39:13.070 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:39:13.298 +08:00 [INF] Request finished in 228.1282ms 200 application/json;charset=utf-8
2019-05-19 16:39:22.864 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:39:22.936 +08:00 [INF] Successfully validated the token.
2019-05-19 16:39:22.967 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:39:22.991 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:39:23.003 +08:00 [INF] Authorization was successful.
2019-05-19 16:39:23.490 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:39:23.712 +08:00 [INF] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:39:24.057 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:39:24.193 +08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:39:24.282 +08:00 [INF] Executed DbCommand (29ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:39:24.551 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 16:39:24.576 +08:00 [INF] Executed DbCommand (164ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:39:24.647 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 1649.5548000000001ms
2019-05-19 16:39:24.650 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:39:24.655 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at Team.Infrastructure.Repositories.RunTeamResource.TeamSearchByIdTeaming(Int32 teamId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 127
   at Team.Infrastructure.Repositories.RunTeamResource.TeamCreate(RunParticipants participants, RunTeam runTeam, Int32 userId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 62
   at Team.Controllers.RunTeamController.RunTeamApi(RunTeamCreateMap runTeam) in D:\Microsoft VS2017\Word\.net core API\Team\Team\Controllers\RunTeamController.cs:line 64
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-19 16:39:24.706 +08:00 [INF] Executed DbCommand (41ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:39:24.785 +08:00 [INF] Request finished in 1921.1363ms 500 text/html; charset=utf-8
2019-05-19 16:43:05.638 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:43:07.102 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:43:07.277 +08:00 [INF] Request finished in 182.7344ms 200 text/html
2019-05-19 16:43:08.098 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:43:08.268 +08:00 [INF] Request finished in 170.4081ms 200 application/json;charset=utf-8
2019-05-19 16:43:33.450 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:43:35.038 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:43:35.208 +08:00 [INF] Request finished in 171.815ms 200 text/html
2019-05-19 16:43:35.785 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:43:35.979 +08:00 [INF] Request finished in 193.8924ms 200 application/json;charset=utf-8
2019-05-19 16:44:05.735 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:44:05.816 +08:00 [INF] Successfully validated the token.
2019-05-19 16:44:05.849 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:44:05.875 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:44:05.887 +08:00 [INF] Authorization was successful.
2019-05-19 16:44:06.210 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:44:06.447 +08:00 [INF] Executed DbCommand (122ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:44:06.767 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:44:06.921 +08:00 [INF] Executed DbCommand (55ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:44:07.024 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:44:07.152 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__teamId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[Id] = @__teamId_0
ORDER BY [x].[Id]
2019-05-19 16:44:07.163 +08:00 [INF] 用户 1 创建跑步队伍失败
2019-05-19 16:44:07.168 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 396.1496ms.
2019-05-19 16:44:07.181 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 16:44:07.192 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamApi (Team) in 1309.3419000000001ms
2019-05-19 16:44:07.198 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:44:07.201 +08:00 [INF] Request finished in 1465.4198ms 500 application/json; charset=utf-8
2019-05-19 16:45:22.302 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamApi application/json-patch+json 50
2019-05-19 16:45:22.332 +08:00 [INF] Successfully validated the token.
2019-05-19 16:45:22.336 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamApi (Team)'
2019-05-19 16:45:22.339 +08:00 [INF] Route matched with {action = "RunTeamApi", controller = "RunTeam"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RunTeamApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:45:22.344 +08:00 [INF] Authorization was successful.
2019-05-19 16:45:22.356 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:45:22.400 +08:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:45:22.429 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamApi (Team) - Validation state: "Valid"
2019-05-19 16:45:22.458 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:46:01.851 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:56:20.926 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 16:56:22.463 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 16:56:22.655 +08:00 [INF] Request finished in 193.0038ms 200 text/html
2019-05-19 16:56:23.267 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 16:56:23.459 +08:00 [INF] Request finished in 191.819ms 200 application/json;charset=utf-8
2019-05-19 16:56:34.367 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 16:56:34.436 +08:00 [INF] Successfully validated the token.
2019-05-19 16:56:34.467 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 16:56:34.487 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 16:56:34.499 +08:00 [INF] Authorization was successful.
2019-05-19 16:56:34.840 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 16:56:35.037 +08:00 [INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 16:56:35.449 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 16:56:35.622 +08:00 [INF] Executed DbCommand (41ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:56:41.037 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:56:41.229 +08:00 [INF] Executed DbCommand (75ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:56:41.299 +08:00 [INF] Executed DbCommand (45ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 16:56:41.364 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
ORDER BY [x].[Id]
2019-05-19 16:56:41.410 +08:00 [INF] Executed DbCommand (34ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [x.RunParticipantses].[Id], [x.RunParticipantses].[ApplicationDate], [x.RunParticipantses].[Name], [x.RunParticipantses].[RunTeamId], [x.RunParticipantses].[Sex], [x.RunParticipantses].[UserId]
FROM [RunParticipantses] AS [x.RunParticipantses]
INNER JOIN (
    SELECT TOP(1) [x0].[Id]
    FROM [RunTeams] AS [x0]
    WHERE [x0].[UserId] = @__userId_0
    ORDER BY [x0].[Id]
) AS [t] ON [x.RunParticipantses].[RunTeamId] = [t].[Id]
ORDER BY [t].[Id]
2019-05-19 16:56:41.453 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 16:56:41.498 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 16:56:41.500 +08:00 [INF] Executed DbCommand (35ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 16:56:41.503 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 6048.6812ms.
2019-05-19 16:56:41.517 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 16:56:41.538 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 7045.6014000000005ms
2019-05-19 16:56:41.541 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 16:56:41.544 +08:00 [INF] Request finished in 7177.262ms 201 application/json; charset=utf-8
2019-05-19 17:02:53.601 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:02:54.840 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:02:55.005 +08:00 [INF] Request finished in 170.4666ms 200 text/html
2019-05-19 17:02:55.586 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:02:55.784 +08:00 [INF] Request finished in 197.7377ms 200 application/json;charset=utf-8
2019-05-19 17:03:08.188 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:03:08.258 +08:00 [INF] Successfully validated the token.
2019-05-19 17:03:08.294 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:03:08.317 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:03:08.328 +08:00 [INF] Authorization was successful.
2019-05-19 17:03:08.647 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:03:08.850 +08:00 [INF] Executed DbCommand (90ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:03:09.212 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:03:09.357 +08:00 [INF] Executed DbCommand (39ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:03:09.443 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:03:09.450 +08:00 [INF] 用户 1 创建跑步队伍失败
2019-05-19 17:03:09.453 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 236.7039ms.
2019-05-19 17:03:09.464 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:03:09.472 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 1150.1334000000002ms
2019-05-19 17:03:09.475 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:03:09.477 +08:00 [INF] Request finished in 1289.0833ms 500 application/json; charset=utf-8
2019-05-19 17:03:13.849 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 17:03:13.852 +08:00 [INF] Successfully validated the token.
2019-05-19 17:03:13.858 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:03:13.864 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:03:13.869 +08:00 [INF] Authorization was successful.
2019-05-19 17:03:13.883 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:03:14.048 +08:00 [INF] Executed DbCommand (151ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:03:14.086 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 17:03:14.129 +08:00 [INF] Executed DbCommand (29ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 17:03:14.175 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:03:14.296 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 17:03:14.298 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 208.96620000000001ms.
2019-05-19 17:03:14.301 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:03:14.302 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 434.59360000000004ms
2019-05-19 17:03:14.305 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:03:14.310 +08:00 [ERR] Connection id "0HLMS733MR0OH", Request id "0HLMS733MR0OH:00000004": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 17:03:14.357 +08:00 [INF] Executed DbCommand (116ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 17:03:14.374 +08:00 [INF] Request finished in 524.9042ms 200 application/json; charset=utf-8
2019-05-19 17:03:14.437 +08:00 [INF] Executed DbCommand (37ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 17:03:20.459 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:03:20.463 +08:00 [INF] Successfully validated the token.
2019-05-19 17:03:20.465 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:03:20.467 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:03:20.470 +08:00 [INF] Authorization was successful.
2019-05-19 17:03:20.471 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:03:20.505 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:03:20.531 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:03:20.557 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:03:20.585 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:03:20.685 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 17:07:06.051 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:07:07.157 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:07:07.344 +08:00 [INF] Request finished in 193.2436ms 200 text/html
2019-05-19 17:07:08.091 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:07:08.290 +08:00 [INF] Request finished in 198.5485ms 200 application/json;charset=utf-8
2019-05-19 17:07:35.217 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 17:07:35.303 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 17:07:35.328 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 17:07:35.665 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:07:35.862 +08:00 [INF] Executed DbCommand (79ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:07:36.218 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 17:07:36.386 +08:00 [INF] Executed DbCommand (63ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 17:07:36.465 +08:00 [INF] 用户 1登陆成功
2019-05-19 17:07:36.472 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 248.94570000000002ms.
2019-05-19 17:07:36.486 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:07:36.498 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1163.7416ms
2019-05-19 17:07:36.501 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 17:07:36.507 +08:00 [INF] Request finished in 1290.4154ms 200 application/json; charset=utf-8
2019-05-19 17:07:58.919 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:07:58.931 +08:00 [INF] Successfully validated the token.
2019-05-19 17:07:58.937 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:07:58.943 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:07:58.955 +08:00 [INF] Authorization was successful.
2019-05-19 17:07:58.959 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:07:59.001 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:07:59.032 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:07:59.084 +08:00 [INF] Executed DbCommand (35ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:08:16.425 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:15:05.674 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:15:07.363 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:15:07.550 +08:00 [INF] Request finished in 188.3958ms 200 text/html
2019-05-19 17:15:08.116 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:15:08.310 +08:00 [INF] Request finished in 193.1992ms 200 application/json;charset=utf-8
2019-05-19 17:15:20.108 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:15:20.177 +08:00 [INF] Successfully validated the token.
2019-05-19 17:15:20.209 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:15:20.235 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:15:20.248 +08:00 [INF] Authorization was successful.
2019-05-19 17:15:20.726 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:15:20.946 +08:00 [INF] Executed DbCommand (91ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:15:21.412 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:15:21.572 +08:00 [INF] Executed DbCommand (41ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:15:21.660 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:15:26.445 +08:00 [INF] 用户 1 创建跑步队伍失败
2019-05-19 17:15:26.452 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 5032.6637ms.
2019-05-19 17:15:26.477 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:15:26.493 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 6251.7738ms
2019-05-19 17:15:26.496 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:15:26.501 +08:00 [INF] Request finished in 6393.5965ms 500 application/json; charset=utf-8
2019-05-19 17:16:24.855 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:16:24.870 +08:00 [INF] Successfully validated the token.
2019-05-19 17:16:24.886 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:16:24.888 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:16:24.893 +08:00 [INF] Authorization was successful.
2019-05-19 17:16:24.926 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:16:24.961 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:16:24.989 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:16:25.047 +08:00 [INF] Executed DbCommand (53ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:16:31.227 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:17:47.177 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:17:48.872 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:17:49.034 +08:00 [INF] Request finished in 163.408ms 200 text/html
2019-05-19 17:17:49.598 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:17:49.778 +08:00 [INF] Request finished in 179.3132ms 200 application/json;charset=utf-8
2019-05-19 17:18:14.373 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:18:14.443 +08:00 [INF] Successfully validated the token.
2019-05-19 17:18:14.477 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:18:14.498 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:18:14.509 +08:00 [INF] Authorization was successful.
2019-05-19 17:18:14.844 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:18:15.034 +08:00 [INF] Executed DbCommand (83ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:18:15.334 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:18:15.472 +08:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:18:19.513 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:18:25.708 +08:00 [INF] Executed DbCommand (50ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:18:25.781 +08:00 [INF] Executed DbCommand (47ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:18:25.839 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
ORDER BY [x].[Id]
2019-05-19 17:18:25.879 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [x.RunParticipantses].[Id], [x.RunParticipantses].[ApplicationDate], [x.RunParticipantses].[Name], [x.RunParticipantses].[RunTeamId], [x.RunParticipantses].[Sex], [x.RunParticipantses].[UserId]
FROM [RunParticipantses] AS [x.RunParticipantses]
INNER JOIN (
    SELECT TOP(1) [x0].[Id]
    FROM [RunTeams] AS [x0]
    WHERE [x0].[UserId] = @__userId_0
    ORDER BY [x0].[Id]
) AS [t] ON [x.RunParticipantses].[RunTeamId] = [t].[Id]
ORDER BY [t].[Id]
2019-05-19 17:18:25.920 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:18:25.954 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 17:18:25.956 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 17:18:25.959 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 10619.7485ms.
2019-05-19 17:18:25.974 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:18:25.996 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 11492.3672ms
2019-05-19 17:18:25.998 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:18:26.000 +08:00 [INF] Request finished in 11626.7582ms 201 application/json; charset=utf-8
2019-05-19 17:31:55.670 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:31:57.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:31:57.534 +08:00 [INF] Request finished in 305.607ms 200 text/html
2019-05-19 17:31:58.096 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:31:58.272 +08:00 [INF] Request finished in 176.2933ms 200 application/json;charset=utf-8
2019-05-19 17:32:05.973 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 17:32:06.064 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 17:32:06.088 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 17:32:06.435 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:32:06.659 +08:00 [INF] Executed DbCommand (89ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:32:07.185 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 17:32:07.360 +08:00 [INF] Executed DbCommand (70ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 17:32:07.466 +08:00 [INF] 用户 1登陆成功
2019-05-19 17:32:07.472 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 281.15360000000004ms.
2019-05-19 17:32:07.492 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:32:07.508 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1414.4087000000002ms
2019-05-19 17:32:07.512 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 17:32:07.520 +08:00 [INF] Request finished in 1547.1388ms 200 application/json; charset=utf-8
2019-05-19 17:32:23.439 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 17:32:23.452 +08:00 [INF] Successfully validated the token.
2019-05-19 17:32:23.458 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:32:23.464 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:32:23.480 +08:00 [INF] Authorization was successful.
2019-05-19 17:32:23.482 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:32:23.516 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:32:23.544 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 17:32:23.627 +08:00 [INF] Executed DbCommand (56ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 17:32:23.682 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:32:23.808 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 17:32:23.811 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 263.9107ms.
2019-05-19 17:32:23.814 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:32:23.815 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 343.7275ms
2019-05-19 17:32:23.817 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:32:23.821 +08:00 [ERR] Connection id "0HLMS7JAUSKOU", Request id "0HLMS7JAUSKOU:00000004": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 17:32:23.862 +08:00 [INF] Executed DbCommand (106ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 17:32:23.897 +08:00 [INF] Request finished in 457.665ms 200 application/json; charset=utf-8
2019-05-19 17:32:23.961 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 17:32:40.451 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:32:40.454 +08:00 [INF] Successfully validated the token.
2019-05-19 17:32:40.457 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:32:40.459 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:32:40.462 +08:00 [INF] Authorization was successful.
2019-05-19 17:32:40.464 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:32:40.497 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:32:40.525 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:32:40.663 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:32:46.552 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:32:49.460 +08:00 [INF] Executed DbCommand (35ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:32:49.500 +08:00 [INF] Executed DbCommand (21ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:32:49.553 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
ORDER BY [x].[Id]
2019-05-19 17:32:49.588 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [x.RunParticipantses].[Id], [x.RunParticipantses].[ApplicationDate], [x.RunParticipantses].[Name], [x.RunParticipantses].[RunTeamId], [x.RunParticipantses].[Sex], [x.RunParticipantses].[UserId]
FROM [RunParticipantses] AS [x.RunParticipantses]
INNER JOIN (
    SELECT TOP(1) [x0].[Id]
    FROM [RunTeams] AS [x0]
    WHERE [x0].[UserId] = @__userId_0
    ORDER BY [x0].[Id]
) AS [t] ON [x.RunParticipantses].[RunTeamId] = [t].[Id]
ORDER BY [t].[Id]
2019-05-19 17:32:49.624 +08:00 [INF] Executed DbCommand (29ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:32:49.660 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 17:32:49.662 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 17:32:49.672 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 9143.6409ms.
2019-05-19 17:32:49.675 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:32:49.696 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 9233.7106ms
2019-05-19 17:32:49.699 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:32:49.701 +08:00 [INF] Request finished in 9250.4555ms 201 application/json; charset=utf-8
2019-05-19 17:35:36.763 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 17:35:36.766 +08:00 [INF] Successfully validated the token.
2019-05-19 17:35:36.768 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:35:36.769 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:35:36.772 +08:00 [INF] Authorization was successful.
2019-05-19 17:35:36.773 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:35:36.805 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:35:36.829 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 17:35:36.858 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 17:35:36.888 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:35:36.921 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 17:35:36.922 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 90.146300000000011ms.
2019-05-19 17:35:36.924 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 17:35:36.924 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:35:36.947 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 174.9539ms
2019-05-19 17:35:36.947 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 17:35:36.953 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:35:36.958 +08:00 [INF] Request finished in 194.5335ms 200 application/json; charset=utf-8
2019-05-19 17:35:42.548 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:35:42.560 +08:00 [INF] Successfully validated the token.
2019-05-19 17:35:42.561 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:35:42.563 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:35:42.565 +08:00 [INF] Authorization was successful.
2019-05-19 17:35:42.567 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:35:42.588 +08:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:35:42.615 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:35:42.642 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:35:42.671 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:35:42.709 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:35:42.709 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 17:38:38.000 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:38:39.511 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:38:39.767 +08:00 [INF] Request finished in 259.5155ms 200 text/html
2019-05-19 17:38:40.363 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:38:40.563 +08:00 [INF] Request finished in 199.423ms 200 application/json;charset=utf-8
2019-05-19 17:38:56.274 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:38:58.042 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:38:58.226 +08:00 [INF] Request finished in 185.554ms 200 text/html
2019-05-19 17:38:58.769 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:38:58.954 +08:00 [INF] Request finished in 184.525ms 200 application/json;charset=utf-8
2019-05-19 17:39:10.489 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 17:39:10.572 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 17:39:10.595 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 17:39:11.058 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:39:11.277 +08:00 [INF] Executed DbCommand (108ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:39:11.696 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 17:39:11.912 +08:00 [INF] Executed DbCommand (77ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 17:39:11.995 +08:00 [INF] 用户 1登陆成功
2019-05-19 17:39:12.001 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 299.8971ms.
2019-05-19 17:39:12.015 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:39:12.028 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1426.1826ms
2019-05-19 17:39:12.031 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 17:39:12.039 +08:00 [INF] Request finished in 1550.6706ms 200 application/json; charset=utf-8
2019-05-19 17:39:24.257 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:39:24.270 +08:00 [INF] Successfully validated the token.
2019-05-19 17:39:24.274 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:39:24.278 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:39:24.294 +08:00 [INF] Authorization was successful.
2019-05-19 17:39:24.299 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:39:24.354 +08:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:39:24.384 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:39:24.437 +08:00 [INF] Executed DbCommand (36ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:39:24.487 +08:00 [INF] Executed DbCommand (29ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:39:24.686 +08:00 [INF] Executed DbCommand (60ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:39:24.741 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:39:24.798 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
ORDER BY [x].[Id]
2019-05-19 17:39:24.838 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [x.RunParticipantses].[Id], [x.RunParticipantses].[ApplicationDate], [x.RunParticipantses].[Name], [x.RunParticipantses].[RunTeamId], [x.RunParticipantses].[Sex], [x.RunParticipantses].[UserId]
FROM [RunParticipantses] AS [x.RunParticipantses]
INNER JOIN (
    SELECT TOP(1) [x0].[Id]
    FROM [RunTeams] AS [x0]
    WHERE [x0].[UserId] = @__userId_0
    ORDER BY [x0].[Id]
) AS [t] ON [x.RunParticipantses].[RunTeamId] = [t].[Id]
ORDER BY [t].[Id]
2019-05-19 17:39:24.877 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:39:24.915 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 17:39:24.917 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 17:39:24.924 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 537.0959ms.
2019-05-19 17:39:24.928 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:39:24.944 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 658.70210000000009ms
2019-05-19 17:39:24.947 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:39:24.949 +08:00 [INF] Request finished in 692.273ms 201 application/json; charset=utf-8
2019-05-19 17:39:45.278 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 17:39:45.281 +08:00 [INF] Successfully validated the token.
2019-05-19 17:39:45.284 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:39:45.286 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:39:45.289 +08:00 [INF] Authorization was successful.
2019-05-19 17:39:45.290 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:39:45.318 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:39:45.340 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 17:39:45.383 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 17:39:45.419 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:39:45.464 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 17:39:45.465 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 123.15390000000001ms.
2019-05-19 17:39:45.467 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 17:39:45.471 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:39:45.496 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 17:39:45.497 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 207.9224ms
2019-05-19 17:39:45.504 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:39:45.506 +08:00 [INF] Request finished in 227.867ms 200 application/json; charset=utf-8
2019-05-19 17:39:48.125 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:39:48.131 +08:00 [INF] Successfully validated the token.
2019-05-19 17:39:48.133 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:39:48.136 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:39:48.141 +08:00 [INF] Authorization was successful.
2019-05-19 17:39:48.143 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:39:48.168 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:39:48.190 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:39:48.218 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:39:48.249 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:39:48.280 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:39:48.306 +08:00 [INF] Executed DbCommand (19ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:39:48.339 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 17:42:08.015 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:42:09.675 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:42:09.872 +08:00 [INF] Request finished in 201.5764ms 200 text/html
2019-05-19 17:42:10.402 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:42:10.582 +08:00 [INF] Request finished in 179.7872ms 200 application/json;charset=utf-8
2019-05-19 17:42:19.321 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 17:42:19.421 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 17:42:19.454 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 17:42:19.820 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:42:20.155 +08:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:42:20.520 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 17:42:20.694 +08:00 [INF] Executed DbCommand (64ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 17:42:20.786 +08:00 [INF] 用户 1登陆成功
2019-05-19 17:42:20.791 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 266.738ms.
2019-05-19 17:42:20.806 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:42:20.817 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1358.8745000000001ms
2019-05-19 17:42:20.821 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 17:42:20.827 +08:00 [INF] Request finished in 1506.0879ms 200 application/json; charset=utf-8
2019-05-19 17:42:35.222 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:42:35.236 +08:00 [INF] Successfully validated the token.
2019-05-19 17:42:35.240 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:42:35.246 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:42:35.261 +08:00 [INF] Authorization was successful.
2019-05-19 17:42:35.267 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:42:35.322 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:42:35.353 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:42:35.411 +08:00 [INF] Executed DbCommand (41ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:42:35.467 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:42:35.690 +08:00 [ERR] Failed executing DbCommand (74ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:a0d452c6-da4c-4438-9fda-bae23a12eb25
Error Number:2601,State:1,Class:14
2019-05-19 17:42:35.757 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Team.Infrastructure.DbContext.MyContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-05-19 17:42:35.803 +08:00 [INF] Executed DbCommand (36ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
ORDER BY [x].[Id]
2019-05-19 17:42:35.810 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 17:43:35.300 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:43:36.668 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:43:36.817 +08:00 [INF] Request finished in 152.6653ms 200 text/html
2019-05-19 17:43:37.383 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:43:37.615 +08:00 [INF] Request finished in 231.3075ms 200 application/json;charset=utf-8
2019-05-19 17:43:54.720 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:43:54.787 +08:00 [INF] Successfully validated the token.
2019-05-19 17:43:54.819 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:43:54.850 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:43:54.863 +08:00 [INF] Authorization was successful.
2019-05-19 17:43:55.187 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:43:55.400 +08:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:43:55.740 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:43:55.872 +08:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:43:55.969 +08:00 [INF] Executed DbCommand (29ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:43:56.200 +08:00 [ERR] Failed executing DbCommand (55ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:b5cf84bf-cb31-4c49-900b-f8c81a7d3981
Error Number:2601,State:1,Class:14
2019-05-19 17:43:56.282 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Team.Infrastructure.DbContext.MyContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-05-19 17:43:56.362 +08:00 [INF] Executed DbCommand (57ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
ORDER BY [x].[Id]
2019-05-19 17:43:56.476 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 17:51:55.892 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:51:57.366 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:51:57.528 +08:00 [INF] Request finished in 163.4447ms 200 text/html
2019-05-19 17:51:58.160 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:51:58.355 +08:00 [INF] Request finished in 195.0583ms 200 application/json;charset=utf-8
2019-05-19 17:52:21.840 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:52:21.915 +08:00 [INF] Successfully validated the token.
2019-05-19 17:52:21.952 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:52:21.974 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:52:21.987 +08:00 [INF] Authorization was successful.
2019-05-19 17:52:22.327 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:52:22.555 +08:00 [INF] Executed DbCommand (93ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:52:22.870 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:52:23.020 +08:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:52:23.270 +08:00 [INF] Executed DbCommand (52ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:52:23.334 +08:00 [INF] Executed DbCommand (42ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:52:23.429 +08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
ORDER BY [x].[Id]
2019-05-19 17:52:23.523 +08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [x.RunParticipantses].[Id], [x.RunParticipantses].[ApplicationDate], [x.RunParticipantses].[Name], [x.RunParticipantses].[RunTeamId], [x.RunParticipantses].[Sex], [x.RunParticipantses].[UserId]
FROM [RunParticipantses] AS [x.RunParticipantses]
INNER JOIN (
    SELECT TOP(1) [x0].[Id]
    FROM [RunTeams] AS [x0]
    WHERE [x0].[UserId] = @__userId_0
    ORDER BY [x0].[Id]
) AS [t] ON [x.RunParticipantses].[RunTeamId] = [t].[Id]
ORDER BY [t].[Id]
2019-05-19 17:52:23.545 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-05-19 17:52:23.648 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 17:52:23.688 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 812.8989ms.
2019-05-19 17:52:23.699 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:52:23.737 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 1756.6723000000002ms
2019-05-19 17:52:23.741 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:52:23.743 +08:00 [INF] Request finished in 1902.6961ms 201 application/json; charset=utf-8
2019-05-19 17:52:54.831 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 17:52:54.836 +08:00 [INF] Successfully validated the token.
2019-05-19 17:52:54.848 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:52:54.855 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:52:54.859 +08:00 [INF] Authorization was successful.
2019-05-19 17:52:54.890 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:52:54.936 +08:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:52:54.969 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 17:52:55.016 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 17:52:55.048 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:52:55.092 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 17:52:55.094 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 121.3157ms.
2019-05-19 17:52:55.096 +08:00 [INF] Executed DbCommand (34ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 17:52:55.101 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 17:52:55.111 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 252.16760000000002ms
2019-05-19 17:52:55.135 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 17:52:55.137 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 17:52:55.140 +08:00 [ERR] Connection id "0HLMS7UGLL9LG", Request id "0HLMS7UGLL9LG:00000004": An unhandled exception was thrown by the application.
System.InvalidOperationException: There is already an open DataReader associated with this Command which must be closed first.
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
2019-05-19 17:52:55.251 +08:00 [INF] Request finished in 419.8633ms 200 application/json; charset=utf-8
2019-05-19 17:52:59.906 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:52:59.910 +08:00 [INF] Successfully validated the token.
2019-05-19 17:52:59.911 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:52:59.914 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:52:59.921 +08:00 [INF] Authorization was successful.
2019-05-19 17:52:59.923 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:52:59.955 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:52:59.980 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:53:00.011 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:53:00.051 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:53:00.052 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSectionAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSectionAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
2019-05-19 17:53:00.076 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 17:53:00.139 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-05-19 17:53:00.153 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: The property 'Id' on entity type 'RunTeam' has a temporary value while attempting to change the entity's state to 'Unchanged'. Either set a permanent value explicitly or ensure that the database is configured to generate values for this property.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: The property 'Id' on entity type 'RunTeam' has a temporary value while attempting to change the entity's state to 'Unchanged'. Either set a permanent value explicitly or ensure that the database is configured to generate values for this property.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.AcceptChanges()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.AcceptAllChanges(IReadOnlyList`1 changedEntries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-05-19 17:53:00.206 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 17:54:42.372 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 17:54:43.864 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 17:54:44.023 +08:00 [INF] Request finished in 160.0686ms 200 text/html
2019-05-19 17:54:44.628 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 17:54:44.863 +08:00 [INF] Request finished in 235.0826ms 200 application/json;charset=utf-8
2019-05-19 17:54:52.723 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 17:54:52.788 +08:00 [INF] Successfully validated the token.
2019-05-19 17:54:52.820 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 17:54:52.842 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 17:54:52.855 +08:00 [INF] Authorization was successful.
2019-05-19 17:54:53.203 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 17:54:53.403 +08:00 [INF] Executed DbCommand (79ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 17:54:53.739 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 17:54:53.867 +08:00 [INF] Executed DbCommand (39ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 17:54:54.230 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 18:33:50.897 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 18:33:52.328 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 18:33:52.487 +08:00 [INF] Request finished in 161.4508ms 200 text/html
2019-05-19 18:33:53.147 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 18:33:53.362 +08:00 [INF] Request finished in 215.2825ms 200 application/json;charset=utf-8
2019-05-19 18:36:20.344 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 18:36:20.412 +08:00 [INF] Successfully validated the token.
2019-05-19 18:36:20.442 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 18:36:20.460 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 18:36:20.472 +08:00 [INF] Authorization was successful.
2019-05-19 18:36:20.829 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 18:36:21.090 +08:00 [INF] Executed DbCommand (129ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 18:36:21.578 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 18:36:21.706 +08:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 18:36:21.940 +08:00 [INF] Executed DbCommand (63ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 18:36:21.999 +08:00 [INF] Executed DbCommand (39ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 18:36:22.072 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
ORDER BY [x].[Id]
2019-05-19 18:36:22.120 +08:00 [INF] Executed DbCommand (35ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [x.RunParticipantses].[Id], [x.RunParticipantses].[ApplicationDate], [x.RunParticipantses].[Name], [x.RunParticipantses].[RunTeamId], [x.RunParticipantses].[Sex], [x.RunParticipantses].[UserId]
FROM [RunParticipantses] AS [x.RunParticipantses]
INNER JOIN (
    SELECT TOP(1) [x0].[Id]
    FROM [RunTeams] AS [x0]
    WHERE [x0].[UserId] = @__userId_0
    ORDER BY [x0].[Id]
) AS [t] ON [x.RunParticipantses].[RunTeamId] = [t].[Id]
ORDER BY [t].[Id]
2019-05-19 18:36:22.126 +08:00 [INF] 用户 1 创建跑步队伍成功
2019-05-19 18:36:22.174 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 18:36:22.176 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 593.33260000000007ms.
2019-05-19 18:36:22.192 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 18:36:22.226 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 1760.2946000000002ms
2019-05-19 18:36:22.228 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 18:36:22.231 +08:00 [INF] Request finished in 1887.0496ms 201 application/json; charset=utf-8
2019-05-19 18:36:37.865 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/RunTeam/DeleteTeamApi  
2019-05-19 18:36:37.871 +08:00 [INF] Successfully validated the token.
2019-05-19 18:36:37.875 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 18:36:37.879 +08:00 [INF] Route matched with {action = "DeleteTeamApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult DeleteTeamApi() on controller Team.Controllers.RunTeamController (Team).
2019-05-19 18:36:37.882 +08:00 [INF] Authorization was successful.
2019-05-19 18:36:37.921 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 18:36:37.957 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 18:36:37.985 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.DeleteTeamApi (Team) - Validation state: "Valid"
2019-05-19 18:36:38.031 +08:00 [INF] Executed DbCommand (34ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[ApplicationStatus], [x].[Count], [x].[CreationTime], [x].[Introduction], [x].[Name], [x].[UserId]
FROM [RunTeams] AS [x]
WHERE [x].[UserId] = @__userId_0
2019-05-19 18:36:38.064 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 18:36:38.104 +08:00 [INF] 用户 1 删除队伍成功
2019-05-19 18:36:38.106 +08:00 [INF] Executed action method Team.Controllers.RunTeamController.DeleteTeamApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 117.2587ms.
2019-05-19 18:36:38.108 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [RunTeams]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;
2019-05-19 18:36:38.109 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 18:36:38.130 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [Account] = @p0, [Name] = @p1, [Password] = @p2, [Province] = @p3, [Role] = @p4, [RunTeamId] = @p5, [Sex] = @p6, [StudentId] = @p7, [UniversityId] = @p8
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;
2019-05-19 18:36:38.132 +08:00 [INF] Executed action Team.Controllers.RunTeamController.DeleteTeamApi (Team) in 249.48360000000002ms
2019-05-19 18:36:38.139 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.DeleteTeamApi (Team)'
2019-05-19 18:36:53.255 +08:00 [ERR] Connection id "0HLMS8LU500AE", Request id "0HLMS8LU500AE:00000004": An unhandled exception was thrown by the application.
System.Data.SqlClient.SqlException (0x80131904): Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding. ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParser.DrainData(TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.Dispose()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ClearTransactions()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.EntityFrameworkCore.DbContext.Dispose()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.Dispose()
   at Microsoft.AspNetCore.Hosting.Internal.RequestServicesFeature.Dispose()
   at Microsoft.AspNetCore.Http.HttpResponse.<>c.<.cctor>b__30_1(Object disposable)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.FireOnCompletedAwaited(Stack`1 onCompleted)
ClientConnectionId:0d79b175-8049-40ff-b026-b425eb55b785
Error Number:-2,State:0,Class:11
2019-05-19 18:36:57.446 +08:00 [INF] Request finished in 19581.602ms 200 application/json; charset=utf-8
2019-05-19 18:36:57.450 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 18:36:57.453 +08:00 [INF] Successfully validated the token.
2019-05-19 18:36:57.455 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 18:36:57.462 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 18:36:57.466 +08:00 [INF] Authorization was successful.
2019-05-19 18:36:57.467 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 18:36:57.507 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 18:36:57.535 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 18:36:57.569 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 18:36:57.618 +08:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 18:36:57.620 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 21:03:17.723 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 21:03:18.993 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 21:03:19.191 +08:00 [INF] Request finished in 199.9038ms 200 text/html
2019-05-19 21:03:19.793 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 21:03:19.999 +08:00 [INF] Request finished in 206.4368ms 200 application/json;charset=utf-8
2019-05-19 21:03:24.779 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 21:03:24.886 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 21:03:24.918 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 21:03:25.377 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:03:25.833 +08:00 [INF] Executed DbCommand (210ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:03:26.261 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 21:03:26.524 +08:00 [INF] Executed DbCommand (120ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 21:03:26.621 +08:00 [INF] 用户 1登陆成功
2019-05-19 21:03:26.629 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 364.2298ms.
2019-05-19 21:03:26.650 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 21:03:26.666 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1739.6076ms
2019-05-19 21:03:26.674 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 21:03:26.683 +08:00 [INF] Request finished in 1903.3795ms 200 application/json; charset=utf-8
2019-05-19 21:03:51.150 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 21:03:51.170 +08:00 [INF] Successfully validated the token.
2019-05-19 21:03:51.175 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 21:03:51.182 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 21:03:51.205 +08:00 [INF] Authorization was successful.
2019-05-19 21:03:51.208 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:03:51.255 +08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:03:51.295 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 21:03:51.369 +08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 21:03:51.699 +08:00 [INF] Executed DbCommand (162ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 21:03:51.784 +08:00 [INF] Executed DbCommand (44ms) [Parameters=[@p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunParticipantses] ([ApplicationDate], [Name], [RunTeamId], [Sex], [UserId])
VALUES (@p6, @p7, @p8, @p9, @p10);
SELECT [Id]
FROM [RunParticipantses]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2019-05-19 21:03:51.787 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 21:39:08.163 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 21:39:09.913 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 21:39:10.084 +08:00 [INF] Request finished in 187.6549ms 200 text/html
2019-05-19 21:39:10.701 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 21:39:10.896 +08:00 [INF] Request finished in 195.6221ms 200 application/json;charset=utf-8
2019-05-19 21:39:33.990 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 21:39:34.070 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 21:39:34.099 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 21:39:34.471 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:39:34.783 +08:00 [INF] Executed DbCommand (204ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:39:35.163 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 21:39:35.447 +08:00 [INF] Executed DbCommand (181ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 21:39:35.518 +08:00 [INF] 用户 1登陆成功
2019-05-19 21:39:35.525 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 356.0699ms.
2019-05-19 21:39:35.538 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 21:39:35.549 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1444.5493000000001ms
2019-05-19 21:39:35.553 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 21:39:35.560 +08:00 [INF] Request finished in 1570.4826ms 200 application/json; charset=utf-8
2019-05-19 21:40:56.076 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 21:40:56.108 +08:00 [INF] Successfully validated the token.
2019-05-19 21:40:56.112 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 21:40:56.117 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 21:40:56.127 +08:00 [INF] Authorization was successful.
2019-05-19 21:40:56.142 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:40:56.385 +08:00 [INF] Executed DbCommand (225ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:40:56.412 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 21:40:56.471 +08:00 [INF] Executed DbCommand (39ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 21:41:11.443 +08:00 [ERR] Failed executing DbCommand (14,852ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:d04fa9f5-6a3b-4c03-bbe3-8b3e26da9cbd
Error Number:2601,State:1,Class:14
2019-05-19 21:41:11.507 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 21:42:11.126 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 21:42:12.527 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 21:42:12.731 +08:00 [INF] Request finished in 207.3398ms 200 text/html
2019-05-19 21:42:13.314 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 21:42:13.524 +08:00 [INF] Request finished in 209.9982ms 200 application/json;charset=utf-8
2019-05-19 21:42:20.851 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 21:42:20.930 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 21:42:20.952 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 21:42:21.255 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:42:21.451 +08:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:42:21.827 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 21:42:21.994 +08:00 [INF] Executed DbCommand (65ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 21:42:22.079 +08:00 [INF] 用户 1登陆成功
2019-05-19 21:42:22.086 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 253.787ms.
2019-05-19 21:42:22.100 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 21:42:22.112 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 1154.7038ms
2019-05-19 21:42:22.116 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 21:42:22.123 +08:00 [INF] Request finished in 1271.6177ms 200 application/json; charset=utf-8
2019-05-19 21:42:53.413 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Login/UserLoginApi application/json-patch+json 49
2019-05-19 21:42:53.430 +08:00 [INF] Executing endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 21:42:53.434 +08:00 [INF] Route matched with {action = "UserLoginApi", controller = "Login"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserLoginApi(Team.Model.AutoMappers.UserMapper.UserLoginMap) on controller Team.Controllers.LoginController (Team).
2019-05-19 21:42:53.450 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:42:53.477 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:42:53.508 +08:00 [INF] Executing action method Team.Controllers.LoginController.UserLoginApi (Team) - Validation state: "Valid"
2019-05-19 21:42:53.563 +08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__account_0='?' (Size = 4000), @__password_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE ([x].[Account] = @__account_0) AND ([x].[Password] = @__password_1)
2019-05-19 21:42:53.569 +08:00 [INF] 用户 1登陆成功
2019-05-19 21:42:53.570 +08:00 [INF] Executed action method Team.Controllers.LoginController.UserLoginApi (Team), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 59.3404ms.
2019-05-19 21:42:53.573 +08:00 [INF] Executing ObjectResult, writing value of type 'Team.Model.CustomStatusCode'.
2019-05-19 21:42:53.575 +08:00 [INF] Executed action Team.Controllers.LoginController.UserLoginApi (Team) in 137.00830000000002ms
2019-05-19 21:42:53.577 +08:00 [INF] Executed endpoint 'Team.Controllers.LoginController.UserLoginApi (Team)'
2019-05-19 21:42:53.578 +08:00 [INF] Request finished in 165.3774ms 200 application/json; charset=utf-8
2019-05-19 21:43:06.710 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 21:43:06.713 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 21:43:06.720 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 21:43:06.733 +08:00 [INF] Authorization failed.
2019-05-19 21:43:06.735 +08:00 [INF] Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter'.
2019-05-19 21:43:06.742 +08:00 [INF] Executing ChallengeResult with authentication schemes ([]).
2019-05-19 21:43:06.753 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2019-05-19 21:43:06.756 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 32.1901ms
2019-05-19 21:43:06.758 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 21:43:06.761 +08:00 [INF] Request finished in 50.9015ms 401 
2019-05-19 21:43:06.765 +08:00 [INF] Connection id "0HLMSBV5RL498", Request id "0HLMSBV5RL498:00000005": the application completed without reading the entire request body.
2019-05-19 21:43:14.464 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 21:43:14.476 +08:00 [INF] Successfully validated the token.
2019-05-19 21:43:14.484 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 21:43:14.487 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 21:43:14.494 +08:00 [INF] Authorization was successful.
2019-05-19 21:43:14.499 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:43:14.563 +08:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:43:14.587 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 21:43:14.642 +08:00 [INF] Executed DbCommand (39ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 21:43:17.159 +08:00 [ERR] Failed executing DbCommand (2,338ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:fb906f88-75df-4613-98cf-975780d64e00
Error Number:2601,State:1,Class:14
2019-05-19 21:43:18.867 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 21:45:31.051 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 21:45:32.468 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 21:45:32.672 +08:00 [INF] Request finished in 207.0897ms 200 text/html
2019-05-19 21:45:33.248 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 21:45:33.462 +08:00 [INF] Request finished in 213.1461ms 200 application/json;charset=utf-8
2019-05-19 21:45:45.479 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 21:45:45.546 +08:00 [INF] Successfully validated the token.
2019-05-19 21:45:45.577 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 21:45:45.602 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 21:45:45.614 +08:00 [INF] Authorization was successful.
2019-05-19 21:45:46.066 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:45:46.257 +08:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:45:46.599 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 21:45:46.726 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 21:45:46.945 +08:00 [ERR] Failed executing DbCommand (51ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:ed87528c-942e-4e19-b90d-14e7852903e0
Error Number:2601,State:1,Class:14
2019-05-19 21:45:55.334 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Team.Infrastructure.DbContext.MyContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-05-19 21:45:55.477 +08:00 [INF] Executed DbCommand (129ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId], [x.RunTeam].[Id], [x.RunTeam].[ApplicationStatus], [x.RunTeam].[Count], [x.RunTeam].[CreationTime], [x.RunTeam].[Introduction], [x.RunTeam].[Name], [x.RunTeam].[UserId]
FROM [Users] AS [x]
LEFT JOIN [RunTeams] AS [x.RunTeam] ON [x].[Id] = [x.RunTeam].[UserId]
WHERE [x].[Id] = @__userId_0
2019-05-19 21:49:19.156 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 21:49:20.520 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 21:49:20.705 +08:00 [INF] Request finished in 186.4636ms 200 text/html
2019-05-19 21:49:21.254 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 21:49:21.455 +08:00 [INF] Request finished in 201.4115ms 200 application/json;charset=utf-8
2019-05-19 21:50:11.845 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 21:50:13.013 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 21:50:13.175 +08:00 [INF] Request finished in 167.3283ms 200 text/html
2019-05-19 21:50:13.735 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 21:50:13.929 +08:00 [INF] Request finished in 194.3084ms 200 application/json;charset=utf-8
2019-05-19 21:50:31.906 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 21:50:31.971 +08:00 [INF] Successfully validated the token.
2019-05-19 21:50:32.002 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 21:50:32.026 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 21:50:32.037 +08:00 [INF] Authorization was successful.
2019-05-19 21:50:32.501 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:50:32.722 +08:00 [INF] Executed DbCommand (102ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:50:33.085 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 21:50:33.210 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 21:50:33.432 +08:00 [ERR] Failed executing DbCommand (52ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:4c1c4334-76d7-4b85-b592-ed33e34b49ed
Error Number:2601,State:1,Class:14
2019-05-19 21:50:33.497 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 21:51:49.156 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Account], [u].[Name], [u].[Password], [u].[Province], [u].[Role], [u].[RunTeamId], [u].[Sex], [u].[StudentId], [u].[UniversityId]
FROM [Users] AS [u]
2019-05-19 21:51:49.191 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Account], [u].[Name], [u].[Password], [u].[Province], [u].[Role], [u].[RunTeamId], [u].[Sex], [u].[StudentId], [u].[UniversityId]
FROM [Users] AS [u]
2019-05-19 21:55:35.079 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 21:55:44.583 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 21:55:44.723 +08:00 [INF] Request finished in 140.371ms 200 text/html
2019-05-19 21:55:45.357 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 21:55:45.547 +08:00 [INF] Request finished in 190.5827ms 200 application/json;charset=utf-8
2019-05-19 21:55:56.575 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 21:55:56.656 +08:00 [INF] Successfully validated the token.
2019-05-19 21:55:56.688 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 21:55:56.709 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 21:55:56.722 +08:00 [INF] Authorization was successful.
2019-05-19 21:55:57.144 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 21:55:57.401 +08:00 [INF] Executed DbCommand (126ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 21:55:57.776 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 21:55:57.927 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 21:55:58.154 +08:00 [ERR] Failed executing DbCommand (51ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:19d231d8-a4bc-4d6b-ae03-9ce6530359d9
Error Number:2601,State:1,Class:14
2019-05-19 21:55:58.221 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 22:00:35.487 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 22:00:37.014 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 22:00:37.220 +08:00 [INF] Request finished in 209.3364ms 200 text/html
2019-05-19 22:00:37.864 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 22:00:38.078 +08:00 [INF] Request finished in 213.4467ms 200 application/json;charset=utf-8
2019-05-19 22:00:44.119 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 22:00:44.189 +08:00 [INF] Successfully validated the token.
2019-05-19 22:00:44.221 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 22:00:44.243 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 22:00:44.256 +08:00 [INF] Authorization was successful.
2019-05-19 22:00:44.632 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 22:00:44.859 +08:00 [INF] Executed DbCommand (85ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 22:00:45.187 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 22:00:45.323 +08:00 [INF] Executed DbCommand (39ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 22:00:45.556 +08:00 [ERR] Failed executing DbCommand (57ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:96c7de0e-de02-4ab4-85db-dabb66596ef2
Error Number:2601,State:1,Class:14
2019-05-19 22:00:45.647 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 22:00:45.674 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Team.Infrastructure.DbContext.MyContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> System.Data.SqlClient.SqlException: 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-05-19 22:01:03.860 +08:00 [INF] Executed action Team.Controllers.RunTeamController.RunTeamCreateApi (Team) in 19608.546000000002ms
2019-05-19 22:01:03.954 +08:00 [INF] Executed endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 22:01:03.956 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at System.Linq.Queryable.SingleOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at Team.Infrastructure.Repositories.RunTeamResource.TeamSearchByUserIdTeaming(Int32 userId) in D:\Microsoft VS2017\Word\.net core API\Team\Team.Infrastructure\Repositories\RunTeamResource.cs:line 137
   at Team.Controllers.RunTeamController.RunTeamCreateApi(RunTeamCreateMap runTeam) in D:\Microsoft VS2017\Word\.net core API\Team\Team\Controllers\RunTeamController.cs:line 78
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-19 22:01:04.084 +08:00 [INF] Request finished in 19965.5456ms 500 text/html; charset=utf-8
2019-05-19 22:03:27.417 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 22:03:28.884 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 22:03:29.133 +08:00 [INF] Request finished in 251.4099ms 200 text/html
2019-05-19 22:03:29.753 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 22:03:30.010 +08:00 [INF] Request finished in 256.9763ms 200 application/json;charset=utf-8
2019-05-19 22:03:36.994 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 22:03:37.068 +08:00 [INF] Successfully validated the token.
2019-05-19 22:03:37.100 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 22:03:37.121 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 22:03:37.132 +08:00 [INF] Authorization was successful.
2019-05-19 22:03:37.562 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 22:03:37.788 +08:00 [INF] Executed DbCommand (116ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 22:03:38.153 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 22:03:38.280 +08:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 22:03:38.533 +08:00 [ERR] Failed executing DbCommand (52ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:bec1a906-3d1c-4237-b80d-94beb4027420
Error Number:2601,State:1,Class:14
2019-05-19 22:03:38.602 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 22:04:56.625 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 22:04:58.266 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 22:04:58.574 +08:00 [INF] Request finished in 310.5774ms 200 text/html
2019-05-19 22:04:59.145 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 22:04:59.356 +08:00 [INF] Request finished in 210.5598ms 200 application/json;charset=utf-8
2019-05-19 22:05:07.448 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 22:05:07.516 +08:00 [INF] Successfully validated the token.
2019-05-19 22:05:07.549 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 22:05:07.570 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 22:05:07.581 +08:00 [INF] Authorization was successful.
2019-05-19 22:05:07.984 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 22:05:08.364 +08:00 [INF] Executed DbCommand (258ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 22:05:08.764 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 22:05:08.924 +08:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 22:05:09.190 +08:00 [ERR] Failed executing DbCommand (54ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:7268d228-2d45-4fd1-b26d-9dacdabd91c1
Error Number:2601,State:1,Class:14
2019-05-19 22:05:56.823 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 22:05:58.117 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 22:05:58.352 +08:00 [INF] Request finished in 239.0136ms 200 text/html
2019-05-19 22:05:59.024 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 22:05:59.207 +08:00 [INF] Request finished in 183.2629ms 200 application/json;charset=utf-8
2019-05-19 22:06:06.462 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 22:06:06.538 +08:00 [INF] Successfully validated the token.
2019-05-19 22:06:06.569 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 22:06:06.590 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 22:06:06.602 +08:00 [INF] Authorization was successful.
2019-05-19 22:06:06.960 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 22:06:07.311 +08:00 [INF] Executed DbCommand (215ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 22:06:07.670 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 22:06:07.804 +08:00 [INF] Executed DbCommand (36ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 22:06:08.032 +08:00 [ERR] Failed executing DbCommand (53ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:ae0e1e83-c281-4139-a60c-882f6bcb7b74
Error Number:2601,State:1,Class:14
2019-05-19 22:11:08.137 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 22:11:09.944 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 22:11:10.110 +08:00 [INF] Request finished in 167.5637ms 200 text/html
2019-05-19 22:11:10.797 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 22:11:11.001 +08:00 [INF] Request finished in 204.2158ms 200 application/json;charset=utf-8
2019-05-19 22:11:22.197 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 22:11:22.268 +08:00 [INF] Successfully validated the token.
2019-05-19 22:11:22.306 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 22:11:22.334 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 22:11:22.349 +08:00 [INF] Authorization was successful.
2019-05-19 22:11:22.695 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 22:11:22.903 +08:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 22:11:23.219 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 22:11:23.350 +08:00 [INF] Executed DbCommand (42ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 22:11:23.591 +08:00 [ERR] Failed executing DbCommand (56ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:4d2011e4-4f4b-4e90-a61c-e0703823b21d
Error Number:2601,State:1,Class:14
2019-05-19 22:11:23.641 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
2019-05-19 22:14:35.681 +08:00 [INF] User profile is available. Using 'C:\Users\10456\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-05-19 22:14:37.096 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html  
2019-05-19 22:14:37.255 +08:00 [INF] Request finished in 165.7785ms 200 text/html
2019-05-19 22:14:37.780 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json  
2019-05-19 22:14:37.953 +08:00 [INF] Request finished in 172.162ms 200 application/json;charset=utf-8
2019-05-19 22:14:49.235 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/RunTeam/RunTeamCreateApi application/json-patch+json 50
2019-05-19 22:14:49.313 +08:00 [INF] Successfully validated the token.
2019-05-19 22:14:49.345 +08:00 [INF] Executing endpoint 'Team.Controllers.RunTeamController.RunTeamCreateApi (Team)'
2019-05-19 22:14:49.366 +08:00 [INF] Route matched with {action = "RunTeamCreateApi", controller = "RunTeam"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RunTeamCreateApi(Team.Model.AutoMappers.RunTeamMapper.RunTeamCreateMap) on controller Team.Controllers.RunTeamController (Team).
2019-05-19 22:14:49.379 +08:00 [INF] Authorization was successful.
2019-05-19 22:14:49.734 +08:00 [INF] Entity Framework Core 2.2.4-servicing-10062 initialized 'MyContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-05-19 22:14:49.989 +08:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE') SELECT 1 ELSE SELECT 0
2019-05-19 22:14:50.309 +08:00 [INF] Executing action method Team.Controllers.RunTeamController.RunTeamCreateApi (Team) - Validation state: "Valid"
2019-05-19 22:14:50.461 +08:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [x].[Id], [x].[Account], [x].[Name], [x].[Password], [x].[Province], [x].[Role], [x].[RunTeamId], [x].[Sex], [x].[StudentId], [x].[UniversityId]
FROM [Users] AS [x]
WHERE [x].[Id] = @__userId_0
2019-05-19 22:14:50.688 +08:00 [ERR] Failed executing DbCommand (52ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [RunTeams] ([ApplicationStatus], [Count], [CreationTime], [Introduction], [Name], [UserId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RunTeams]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
System.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_RunTeams_UserId”的对象“dbo.RunTeams”中插入重复键的行。重复键值为 (1)。
语句已终止。
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__122_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
ClientConnectionId:2748f60f-081c-4911-b508-dc8bb057d646
Error Number:2601,State:1,Class:14
2019-05-19 22:14:50.752 +08:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Team.Infrastructure.DbContext.MyContext'.
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
System.InvalidOperationException: A second operation started on this context before a previous operation completed. This is usually caused by different threads using the same instance of DbContext, however instance members are not guaranteed to be thread safe. This could also be caused by a nested query being evaluated on the client, if this is the case rewrite the query avoiding nested invocations.
   at Microsoft.EntityFrameworkCore.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Linq.Enumerable.TryGetFirst[TSource](IEnumerable`1 source, Boolean& found)
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass15_1`1.<CompileQueryCore>b__0(QueryContext qc)
